{
  "timestamp": "2025-11-18T21:07:12+08:00",
  "known": [
    "README.md 已定义 API、Worker、MCP、Web 以及 packages/* 的职责划分，核心 runtime 为 Bun + TypeScript，数据面包括 Postgres/pgvector/Qdrant/MinIO/RabbitMQ。",
    "apps/api/src/main.ts 与 routes.ts 构成上传、队列入栈、检索、治理及 /mcp/* 代理的实现入口，startApiServer 负责 CORS/Auth/Metrics。",
    "apps/worker/src/worker.ts + pipeline.ts 实现 fetch → parse → chunk → metadata → embed → persist 的 ingestion 流程，并依赖 packages/core 中的 parser、OCR、vector client、semantic metadata 等模块。",
    "apps/mcp/src/server.ts 和 tools/{search,related,preview}.ts 暴露 kb.* 工具，复用数据库与 HybridRetriever；packages/data 将各 storage/repo/queue 抽象。"
  ],
  "questions": [
    {
      "id": "Q1",
      "question": "最终功能拆解文档需要覆盖哪些一级业务功能？是否以\"上传/治理/检索/MCP/运维脚本\"为纲，还是按 API/Worker/MCP/Packages 模块划分？",
      "priority": "high",
      "blocking": true
    },
    {
      "id": "Q2",
      "question": "每个功能对应的核心 TypeScript 文件与关键函数有哪些？需要逐个定位 apps/api、apps/worker、apps/mcp、packages/core/data 的实现以便文档引用。",
      "priority": "high",
      "blocking": true
    },
    {
      "id": "Q3",
      "question": "数据在\"上传→对象存储→队列→worker→向量/数据库→检索/MCP\"过程中，哪些模块负责转换/过滤/打标签？需要确认 pipeline.ts、retrieval.ts、routes.ts、mcp 工具之间的调用链并描述。",
      "priority": "high",
      "blocking": true
    },
    {
      "id": "Q4",
      "question": "文档是否需要包含 Web 控制台或脚本（ops/scripts、scripts/）的功能点，还是聚焦后端？若需涵盖，需要找到对应 TS 实现。",
      "priority": "medium",
      "blocking": false
    }
  ]
}
